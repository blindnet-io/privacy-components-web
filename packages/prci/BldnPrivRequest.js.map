{"version":3,"file":"BldnPrivRequest.js","sources":["../src/BldnPrivRequest.ts"],"sourcesContent":["/* eslint-disable no-restricted-globals */\n/* eslint-disable no-param-reassign */\nimport { html, css, LitElement, PropertyValueMap, TemplateResult } from 'lit';\nimport { customElement, property, state } from 'lit/decorators.js';\nimport { choose } from 'lit/directives/choose.js';\nimport { map } from 'lit/directives/map.js';\nimport { localized, msg } from '@lit/localize';\n\nimport './FrequentRequestsMenu.js';\nimport './ResponseView.js';\nimport './ReviewView.js';\nimport './ActionMenu.js';\nimport './RequestsView.js';\nimport './StatusView.js';\nimport './demand-forms/TransparencyForm.js';\nimport './demand-forms/AccessForm.js';\nimport './demand-forms/DeleteForm.js';\nimport { ACTION, TARGET } from './models/priv-terms.js';\nimport { PrivacyRequest } from './models/privacy-request.js';\nimport { ComponentState } from './utils/states.js';\nimport { Demand } from './models/demand.js';\nimport {\n  getDefaultActions,\n  getDefaultDemand,\n  getDefaultDemands,\n} from './utils/utils.js';\nimport { buttonStyles, containerStyles, textStyles } from './styles.js';\nimport { PRCI_CONFIG } from './utils/conf.js';\nimport { sendPrivacyRequest } from './utils/privacy-request-api.js';\n\n/**\n * Top level component encapsulating a single PrivacyRequest. Contains one or\n * more DemandBuilder elements, each for a single demand action type.\n */\n@customElement('bldn-priv-request')\n@localized()\nexport class BldnPrivRequest extends LitElement {\n  // JSON string of actions to display\n  @property({ type: String, attribute: 'actions' }) actions = '';\n\n  // Array of actions, given by actions attribute if a valid list was passed, otherwise includes the 9 defaults\n  @state() _includedActions: ACTION[] = getDefaultActions();\n\n  // State of the PRCI component\n  @state() _componentState: ComponentState = ComponentState.MENU;\n\n  // Currently selected action\n  @state() _selectedAction: ACTION = ACTION.TRANSPARENCY;\n\n  // Privacy request object, empty until some demands are added\n  @state() _privacyRequest: PrivacyRequest = {\n    demands: [],\n    data_subject: [\n      {\n        // FIXME: For now we hardcode this, but will come from token once auth added\n        id: 'fdfc95a6-8fd8-4581-91f7-b3d236a6a10e',\n        schema: 'dsid',\n      },\n    ],\n    email: '',\n    target: TARGET.PARTNERS,\n  };\n\n  // Map of demand group ids to sets of demands\n  @state() _demands: Map<string, Demand[]> = new Map<string, Demand[]>();\n\n  @state() _currentDemandGroupId: string = '';\n\n  @state() _currentRequestId: string = '';\n\n  @state() _config = PRCI_CONFIG;\n\n  constructor() {\n    super();\n\n    // Initialize demands and current demand group to the same uuid\n    const initialGroup = self.crypto.randomUUID();\n    this._demands.set(initialGroup, []);\n    this._currentDemandGroupId = initialGroup;\n\n    // State change listener\n    this.addEventListener('component-state-change', e => {\n      const details = (e as CustomEvent).detail;\n      this._componentState = details.newState;\n\n      switch (this._componentState) {\n        case ComponentState.EDIT:\n          this._selectedAction = details.newAction;\n          if (details.demandGroupId !== undefined) {\n            this._currentDemandGroupId = details.demandGroupId;\n          }\n          break;\n        case ComponentState.SUBMITTED:\n          break;\n        case ComponentState.MENU:\n          // For now, going back to the menu means we reset. This will change\n          // when supporting multiple demands.\n          this._demands.set(this._currentDemandGroupId, []);\n          break;\n        case ComponentState.STATUS:\n          this._currentRequestId = details.requestId;\n          break;\n        default:\n          break;\n      }\n    });\n\n    // Demand update listener\n    this.addEventListener('demand-set-multiple', e => {\n      const { demandGroupId, demands } = (e as CustomEvent).detail;\n      this._demands.set(demandGroupId, demands);\n    });\n    this.addEventListener('demand-set', e => {\n      const { demandGroupId, demand } = (e as CustomEvent).detail;\n      this._demands.set(demandGroupId, [demand]);\n    });\n    this.addEventListener('demand-delete', e => {\n      const { demandGroupId } = (e as CustomEvent).detail;\n      this._demands.delete(demandGroupId);\n      this.requestUpdate();\n    });\n\n    // Request target listener\n    this.addEventListener('request-target-change', e => {\n      const { id } = (e as CustomEvent).detail;\n      this._privacyRequest.target = id as TARGET;\n    });\n\n    // Submit request listener\n    this.addEventListener('submit-request', () => {\n      const allDemands = Array.from(this._demands.values()).reduce(\n        (dmds, dmdGroup) => dmds.concat(dmdGroup),\n        []\n      );\n      this._privacyRequest.demands = allDemands.map((d, i) => {\n        d.id = i.toString();\n        return d;\n      });\n\n      sendPrivacyRequest(this._privacyRequest, false).then(response => {\n        this.dispatchEvent(\n          new CustomEvent('component-state-change', {\n            detail: {\n              newState: ComponentState.STATUS,\n              requestId: response.request_id,\n            },\n          })\n        );\n      });\n    });\n  }\n\n  static styles = [\n    buttonStyles,\n    textStyles,\n    containerStyles,\n    css`\n      :host {\n        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto,\n          Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\n        font-size: 16;\n        background-color: white;\n        text-align: left;\n      }\n\n      :host button {\n        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto,\n          Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\n      }\n\n      :host p {\n        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto,\n          Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\n        margin: 0px;\n      }\n\n      :host span {\n        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto,\n          Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;\n      }\n\n      #prci-ctr {\n        padding: 20px;\n        max-width: 1350px;\n      }\n\n      #nav-bar {\n        display: grid;\n        grid-template-columns: repeat(3, 1fr);\n        align-items: center;\n        padding: 0px 0px 20px 0px;\n      }\n\n      #new-dmd-ctr {\n        display: flex;\n        column-gap: 10px;\n        padding: 20px;\n        align-items: center;\n        justify-content: center;\n      }\n\n      #request-progress-indicator {\n        background-color: red;\n      }\n\n      #frequent-requests {\n        background-color: green;\n      }\n\n      #restart-btn {\n        background: #fafafa;\n        border: none;\n        width: fit-content;\n        height: fit-content;\n        text-decoration: underline;\n        margin: 20px 0px;\n      }\n\n      #req-sent-hdr {\n        padding: 40px 0px;\n      }\n\n      #other-dmd-btn {\n        margin: 20px 0px 0px 0px;\n        float: right;\n      }\n\n      #heading-ctr {\n        padding: 0px 0px 40px 0px;\n        max-width: 1170px;\n      }\n\n      .req-hdr {\n        display: block;\n        font-weight: bold;\n        font-size: 24px;\n        grid-column: 2/3;\n        text-align: center;\n      }\n\n      .new-dmd-btn {\n        width: 20px;\n        display: flex;\n        justify-content: center;\n        align-items: center;\n        text-align: center;\n      }\n\n      button:disabled {\n        /* background-color: #d9d9d9; */\n        background-color: #a9d1ff;\n      }\n\n      .ctr-btn {\n        justify-self: center;\n      }\n\n      .demand-builder-next-btn {\n        grid-column: 2/3;\n        padding-bottom: -50px;\n        margin-bottom: -50px;\n      }\n\n      .ctr-txt {\n        text-align: center;\n      }\n    `,\n  ];\n\n  /**\n   * Reset most states\n   * // TODO: Remove this and use something like getDefaultDemand() from the forms\n   */\n  handleRestartClick() {\n    this._privacyRequest = {\n      demands: [],\n      data_subject: [\n        {\n          // FIXME: For now we hardcode this, but will come from token once auth added\n          id: 'fdfc95a6-8fd8-4581-91f7-b3d236a6a10e',\n          schema: 'dsid',\n        },\n      ],\n      email: '',\n      target: TARGET.PARTNERS,\n    };\n    this._demands = new Map<string, Demand[]>();\n  }\n\n  /**\n   * Return a form based on action type with either default or prepopulated demand data\n   * @param action PRIV action for which to return a form\n   * @returns\n   */\n  actionFormFactory(action: ACTION) {\n    const currentDemand = this._demands.get(this._currentDemandGroupId);\n\n    // Handle the transparency action case where we have multiple demands per form\n    if (action === ACTION.TRANSPARENCY) {\n      // Decide if we should use the default demand or not\n      const multiDemand =\n        currentDemand && currentDemand.length !== 0\n          ? currentDemand\n          : getDefaultDemands(action);\n      return html`\n        <transparency-form\n          .demands=${multiDemand}\n          .demandGroupId=${this._currentDemandGroupId}\n          .restrictions=${multiDemand[0].restrictions}\n        ></transparency-form>\n      `;\n    }\n\n    // Decide if we should use the default demand or not\n    const demand =\n      currentDemand && currentDemand.length !== 0\n        ? currentDemand[0]\n        : getDefaultDemand(action);\n    // Get the form for all other action types\n    return html`\n      ${choose(\n        action,\n        [\n          [\n            ACTION.ACCESS,\n            () => html`\n              <access-form\n                .demand=${demand}\n                .demandGroupId=${this._currentDemandGroupId}\n                .allowedDataCategories=${this._config[\n                  'access-allowed-data-categories'\n                ]}\n              ></access-form>\n            `,\n          ],\n          [\n            ACTION.DELETE,\n            () => html`\n              <delete-form\n                .demand=${demand}\n                .demandGroupId=${this._currentDemandGroupId}\n                .allowedDataCategories=${this._config[\n                  'delete-allowed-data-categories'\n                ]}\n              ></delete-form>\n            `,\n          ],\n          [ACTION.MODIFY, () => html``],\n          [ACTION.OBJECT, () => html``],\n          [ACTION.PORTABILITY, () => html``],\n          [ACTION.RESTRICT, () => html``],\n          [ACTION.REVOKE, () => html``],\n          [ACTION['OTHER.DEMAND'], () => html``],\n        ],\n        () => html`${msg('Error: Invalid Action')}`\n      )}\n    `;\n  }\n\n  getHeadingString(componentState: ComponentState): TemplateResult<1 | 2> {\n    switch (componentState) {\n      case ComponentState.REQUESTS:\n        return html`${msg('My Submitted Privacy Request(s)')}`;\n      case ComponentState.STATUS:\n        return html`${msg('My Privacy Request Status')}`;\n      default:\n        return html`${msg('My Privacy Request')}`;\n    }\n  }\n\n  // Hook into willUpdate lifecycle method to set the included actions state if a valid list of actions is passed as an attribute\n  protected willUpdate(\n    _changedProperties: PropertyValueMap<any> | Map<PropertyKey, unknown>\n  ): void {\n    if (_changedProperties.has('actions') && this.actions) {\n      try {\n        const actionsList = (\n          Array.from(JSON.parse(this.actions)) as string[]\n        ).map(a => a.toLocaleLowerCase());\n        const validActionsList = getDefaultActions().filter(a =>\n          actionsList.includes(a.toLocaleLowerCase())\n        );\n        // If a valid list of actions has been passed, use it\n        if (validActionsList.length > 0) {\n          this._includedActions = validActionsList;\n        }\n      } catch {\n        this._includedActions = getDefaultActions();\n      }\n    }\n  }\n\n  render() {\n    return html`\n      <div id=\"prci-ctr\">\n        <div id=\"heading-ctr\">\n          <span class=\"req-hdr\"\n            >${this.getHeadingString(this._componentState)}</span\n          >\n        </div>\n        ${choose(this._componentState, [\n          [\n            ComponentState.MENU,\n            () => html`\n              <div>\n                <action-menu\n                  .includedActions=${this._includedActions}\n                ></action-menu>\n              </div>\n            `,\n          ],\n          [\n            ComponentState.EDIT,\n            () => html`\n              <div class=\"medium-border view-ctr\">\n                ${this.actionFormFactory(this._selectedAction)}\n              </div>\n            `,\n          ],\n          [\n            ComponentState.REVIEW,\n            () => html`\n              <div class=\"medium-border view-ctr\">\n                ${map(\n                  this._demands.entries(),\n                  ([groupId, demands]) => html`<review-view\n                    .demandGroupId=${groupId}\n                    .demands=${demands}\n                  ></review-view>`\n                )}\n              </div>\n            `,\n          ],\n          [\n            ComponentState.REQUESTS,\n            () => html` <requests-view></requests-view> `,\n          ],\n          [\n            ComponentState.STATUS,\n            () =>\n              html` <status-view\n                request-id=${this._currentRequestId}\n              ></status-view>`,\n          ],\n          [\n            ComponentState.SUBMITTED,\n            () => html`\n              <p class=\"ctr-txt\">\n                <b>${msg('Your Privacy Request has been sent!')} ðŸŽ‰</b>\n              </p>\n              <p class=\"ctr-txt\">\n                ${msg('You may track the status of your request below.')}\n              </p>\n            `,\n          ],\n          [ComponentState.AUTH, () => html` <auth-view></auth-view> `],\n        ])}\n      </div>\n    `;\n  }\n}\n"],"names":[],"mappings":"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"}