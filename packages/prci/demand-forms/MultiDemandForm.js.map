{"version":3,"file":"MultiDemandForm.js","sources":["../../src/demand-forms/MultiDemandForm.ts"],"sourcesContent":["import { msg } from '@lit/localize';\nimport { css, CSSResultGroup, html, LitElement, TemplateResult } from 'lit';\nimport { property } from 'lit/decorators.js';\nimport { choose } from 'lit/directives/choose.js';\nimport { Demand, ACTION } from '@blindnet/core';\nimport { PRCIStyles } from '../styles.js';\nimport { ComponentState, DemandState } from '../utils/states.js';\n\n/**\n * Abstract class for a form that allows the user to create or edit multiple demands.\n */\nexport abstract class MultiDemandForm extends LitElement {\n  static styles = [\n    PRCIStyles,\n    css`\n      :host {\n        margin: 0px;\n      }\n\n      .btns-ctr {\n        display: grid;\n        grid-template-columns: 1fr auto 1fr;\n        padding: 0px 0px 0px 0px;\n        margin: 0px 0px 0px 0px;\n        transform: translateY(35px);\n      }\n\n      #back-btn {\n        grid-column: 1/2;\n        min-width: 60%;\n        max-width: 300px;\n      }\n\n      #add-btn {\n        grid-column: 3/4;\n        min-width: 60%;\n        max-width: 300px;\n      }\n\n      h1,\n      h2,\n      h3,\n      h4,\n      h5,\n      h6 {\n        padding: 0;\n        margin: 0;\n      }\n\n      h2 {\n        font-size: 20px;\n      }\n\n      h3 {\n        font-size: 16px;\n        font-weight: normal;\n      }\n    ` as CSSResultGroup,\n  ];\n\n  @property({ type: Number, attribute: 'demand-state' })\n  demandState: DemandState = DemandState.EDIT_OPEN;\n\n  // eslint-disable-next-line no-restricted-globals\n  @property({ type: String }) demandGroupId = self.crypto.randomUUID();\n\n  @property({ attribute: false }) demands: Demand[] = [];\n\n  setDemand(demand: Demand) {\n    this.demands.push(demand);\n  }\n\n  deleteDemand(action: ACTION) {\n    this.demands.splice(\n      this.demands.findIndex(d => d.action === action),\n      1\n    );\n  }\n\n  addToPrivacyRequest(demandGroupId: string, demands: Demand[]) {\n    this.dispatchEvent(\n      new CustomEvent('demand-set-multiple', {\n        bubbles: true,\n        composed: true,\n        detail: {\n          demandGroupId,\n          demands,\n        },\n      })\n    );\n  }\n\n  /**\n   * Go back to the action menu\n   */\n  handleBackClick() {\n    this.dispatchEvent(\n      new CustomEvent('component-state-change', {\n        bubbles: true,\n        composed: true,\n        detail: {\n          newState: ComponentState.MENU,\n        },\n      })\n    );\n  }\n\n  /**\n   * On add click validate and add data then move to review\n   */\n  handleAddClick() {\n    if (this.validate()) {\n      // Create list of demands from data entered in the form\n      this.demands = this.buildDemands();\n      // Send the demands to the top level component to be added to priacy request\n      this.addToPrivacyRequest(this.demandGroupId, this.demands);\n      // Move to review state\n      this.dispatchEvent(\n        new CustomEvent('component-state-change', {\n          bubbles: true,\n          composed: true,\n          detail: {\n            newState: ComponentState.REVIEW,\n          },\n        })\n      );\n    }\n  }\n\n  /**\n   * Validate data entered before adding to Privacy Request\n   */\n  abstract validate(): boolean;\n\n  /**\n   * Create a list of demands from the data entered in the form\n   */\n  abstract buildDemands(): Demand[];\n\n  /**\n   * Get the edit template for this action\n   * @param useDefault Indicates if form should be populated with default values or from input demands\n   * @returns HTML template\n   */\n  abstract getFormTemplate(): TemplateResult;\n\n  render(): TemplateResult<1 | 2> {\n    return html`\n      ${choose(this.demandState, [\n        [DemandState.EDIT_OPEN, () => this.getFormTemplate()],\n      ])}\n      <!-- Buttons -->\n      <div class=\"btns-ctr\">\n        <button\n          id=\"back-btn\"\n          class=\"nav-btn btn--centered btn--clickable\"\n          @click=${this.handleBackClick}\n        >\n          ${msg('Back')}\n        </button>\n        <button\n          id=\"add-btn\"\n          class=\"nav-btn btn--centered btn--clickable\"\n          @click=${this.handleAddClick}\n        >\n          ${msg('Next')}\n        </button>\n      </div>\n    `;\n  }\n}\n"],"names":[],"mappings":"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"}