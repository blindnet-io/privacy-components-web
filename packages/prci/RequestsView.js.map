{"version":3,"file":"RequestsView.js","sources":["../src/RequestsView.ts"],"sourcesContent":["import { msg } from '@lit/localize';\nimport { css, html, LitElement } from 'lit';\nimport { customElement, state } from 'lit/decorators.js';\nimport { map } from 'lit/directives/map.js';\nimport {\n  REQUEST_STATUS,\n  RequestHistoryItem,\n  ComputationAPI,\n} from '@blindnet/core';\nimport { PRCIStyles } from './styles.js';\nimport { STATUS_DESCRIPTIONS } from './utils/dictionary.js';\nimport { ComponentState } from './utils/states.js';\n\n@customElement('requests-view')\nexport class RequestsView extends LitElement {\n  static styles = [\n    PRCIStyles,\n    css`\n      :host {\n        display: grid;\n        max-width: 1000px;\n        margin: auto;\n        row-gap: 40px;\n        justify-items: center;\n      }\n\n      #table-ctr {\n        width: 100%;\n      }\n\n      #requests-list {\n        display: grid;\n        row-gap: 30px;\n      }\n\n      .list__row--header {\n        display: grid;\n        padding: 0px 10px;\n        grid-column-gap: 5px;\n        grid-template-columns: 3fr 2fr 1fr 2fr;\n        text-align: center;\n      }\n\n      .list__row {\n        display: grid;\n        grid-template-columns: 3fr 2fr 1fr 2fr;\n        grid-column-gap: 5px;\n        padding: 20px 10px;\n        border: 2px solid #5b5b5b;\n        border-radius: 10px;\n        box-shadow: 0px 5px 10px 0px rgba(0, 0, 0, 0.5);\n      }\n\n      .list__field {\n        display: inline-flex;\n        justify-items: center;\n        text-align: center;\n        justify-self: center;\n        align-items: center;\n      }\n\n      .list__field:last-child {\n        padding: 0px 20px 0px 0px;\n      }\n\n      #new-request-btn {\n        font-size: 18px;\n      }\n    `,\n  ];\n\n  @state() _requests: RequestHistoryItem[] = [];\n\n  connectedCallback(): void {\n    // eslint-disable-next-line wc/guard-super-call\n    super.connectedCallback();\n\n    ComputationAPI.getInstance()\n      .getRequestHistory()\n      .then(response => {\n        this._requests = response.history;\n      });\n  }\n\n  handleRequestClick(e: Event) {\n    this.dispatchEvent(\n      new CustomEvent('component-state-change', {\n        bubbles: true,\n        composed: true,\n        detail: {\n          newState: ComponentState.STATUS,\n          requestId: (e.target as HTMLInputElement).id,\n        },\n      })\n    );\n  }\n\n  handleNewRequestClick() {\n    this.dispatchEvent(\n      new CustomEvent('component-state-change', {\n        bubbles: true,\n        composed: true,\n        detail: {\n          newState: ComponentState.MENU,\n        },\n      })\n    );\n  }\n\n  render() {\n    return html`\n      <div id=\"table-ctr\">\n        <div id=\"requests-list\">\n          <div class=\"list__row--header\">\n            <span><b>${msg('Created')}</b></span>\n            <span><b>${msg('Status')}</b></span>\n            <span><b>${msg('Demands')}</b></span>\n            <span></span>\n          </div>\n          ${map(\n            this._requests,\n            r => html`\n              <div class=\"list__row\">\n                <span class=\"list__field\"\n                  >${new Date(r.date).toLocaleString()}</span\n                >\n                <span class=\"list__field\"\n                  >${STATUS_DESCRIPTIONS[r.status as REQUEST_STATUS]()}</span\n                >\n                <span class=\"list__field\">${r.demands}</span>\n                <button\n                  id=${r.id}\n                  class=\"link-btn dark-font text--underline list__field\"\n                  @click=${this.handleRequestClick}\n                >\n                  ${msg('See Details')}\n                </button>\n              </div>\n            `\n          )}\n        </div>\n      </div>\n      <div id=\"new-request-ctr\">\n        <button\n          id=\"new-request-btn\"\n          class=\"link-btn dark-font text--underline\"\n          @click=${this.handleNewRequestClick}\n        >\n          ${msg('Submit a new Privacy Request')}\n        </button>\n      </div>\n    `;\n  }\n}\n"],"names":[],"mappings":";;;;;;;;;;AAcA,IAAa,YAAY,GAAzB,MAAa,YAAa,SAAQ,UAAU,CAAA;AAA5C,IAAA,WAAA,GAAA;;QAyDW,IAAS,CAAA,SAAA,GAAyB,EAAE,CAAC;KAkF/C;IAhFC,iBAAiB,GAAA;;QAEf,KAAK,CAAC,iBAAiB,EAAE,CAAC;QAE1B,cAAc,CAAC,WAAW,EAAE;AACzB,aAAA,iBAAiB,EAAE;aACnB,IAAI,CAAC,QAAQ,IAAG;AACf,YAAA,IAAI,CAAC,SAAS,GAAG,QAAQ,CAAC,OAAO,CAAC;AACpC,SAAC,CAAC,CAAC;KACN;AAED,IAAA,kBAAkB,CAAC,CAAQ,EAAA;AACzB,QAAA,IAAI,CAAC,aAAa,CAChB,IAAI,WAAW,CAAC,wBAAwB,EAAE;AACxC,YAAA,OAAO,EAAE,IAAI;AACb,YAAA,QAAQ,EAAE,IAAI;AACd,YAAA,MAAM,EAAE;gBACN,QAAQ,EAAE,cAAc,CAAC,MAAM;AAC/B,gBAAA,SAAS,EAAG,CAAC,CAAC,MAA2B,CAAC,EAAE;AAC7C,aAAA;AACF,SAAA,CAAC,CACH,CAAC;KACH;IAED,qBAAqB,GAAA;AACnB,QAAA,IAAI,CAAC,aAAa,CAChB,IAAI,WAAW,CAAC,wBAAwB,EAAE;AACxC,YAAA,OAAO,EAAE,IAAI;AACb,YAAA,QAAQ,EAAE,IAAI;AACd,YAAA,MAAM,EAAE;gBACN,QAAQ,EAAE,cAAc,CAAC,IAAI;AAC9B,aAAA;AACF,SAAA,CAAC,CACH,CAAC;KACH;IAED,MAAM,GAAA;AACJ,QAAA,OAAO,IAAI,CAAA,CAAA;;;;uBAIQ,GAAG,CAAC,SAAS,CAAC,CAAA;uBACd,GAAG,CAAC,QAAQ,CAAC,CAAA;uBACb,GAAG,CAAC,SAAS,CAAC,CAAA;;;YAGzB,GAAG,CACH,IAAI,CAAC,SAAS,EACd,CAAC,IAAI,IAAI,CAAA,CAAA;;;qBAGA,IAAI,IAAI,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,cAAc,EAAE,CAAA;;;AAGjC,mBAAA,EAAA,mBAAmB,CAAC,CAAC,CAAC,MAAwB,CAAC,EAAE,CAAA;;AAE1B,0CAAA,EAAA,CAAC,CAAC,OAAO,CAAA;;AAE9B,qBAAA,EAAA,CAAC,CAAC,EAAE,CAAA;;AAEA,yBAAA,EAAA,IAAI,CAAC,kBAAkB,CAAA;;oBAE9B,GAAG,CAAC,aAAa,CAAC,CAAA;;;aAGzB,CACF,CAAA;;;;;;;AAOQ,iBAAA,EAAA,IAAI,CAAC,qBAAqB,CAAA;;YAEjC,GAAG,CAAC,8BAA8B,CAAC,CAAA;;;KAG1C,CAAC;KACH;EACF;AA1IQ,YAAA,CAAA,MAAM,GAAG;IACd,UAAU;AACV,IAAA,GAAG,CAAA,CAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAmDF,IAAA,CAAA;CACF,CAAC;AAEO,UAAA,CAAA;AAAR,IAAA,KAAK,EAAE;AAAsC,CAAA,EAAA,YAAA,CAAA,SAAA,EAAA,WAAA,EAAA,KAAA,CAAA,CAAA,CAAA;AAzDnC,YAAY,GAAA,UAAA,CAAA;IADxB,aAAa,CAAC,eAAe,CAAC;AAClB,CAAA,EAAA,YAAY,CA2IxB;;;;"}