{"version":3,"file":"bldn-delete-form.js","sources":["../../../src/request-builder/action-forms/bldn-delete-form.ts"],"sourcesContent":["import {\n  PrivacyRequestDemand,\n  PrivacyScopeRestriction,\n  ProvenanceRestriction,\n} from '@blindnet/core';\nimport { msg } from '@lit/localize';\nimport { css, html, TemplateResult } from 'lit';\nimport { customElement, property } from 'lit/decorators.js';\nimport { ifDefined } from 'lit/directives/if-defined.js';\nimport {\n  DATA_CATEGORY_DESCRIPTIONS,\n  DATA_CATEGORY_TITLES,\n} from '../../utils/dictionary.js';\nimport { ActionForm } from './bldn-action-form.js';\n\n/**\n * Action form for the DELETE PRIV Action\n */\n@customElement('bldn-delete-form')\nexport class BldnDeleteForm extends ActionForm {\n  /** @prop */\n  @property({ type: Array, attribute: 'data-categories' })\n  dataCategories: string[] = [];\n\n  action: PrivacyRequestDemand.action = PrivacyRequestDemand.action.DELETE;\n\n  validateActionInput(): string[] | undefined {\n    return undefined;\n  }\n\n  validateOptionsInput(): string[] | undefined {\n    return undefined;\n  }\n\n  getFormTemplate(): TemplateResult<1 | 2> {\n    return html`\n      <p>${msg('I want to delete data from the following categories:')}</p>\n      <bldn-all-checklist\n        .choices=${this.dataCategories.map(dc => ({\n          value: dc,\n          display: html`${dc === '*'\n            ? ''\n            : html`<b\n                >${DATA_CATEGORY_TITLES[dc]()}:\n              </b>`}${DATA_CATEGORY_DESCRIPTIONS[dc]()}`,\n          checked:\n            this.demands![0].restrictions?.privacy_scope?.findIndex(\n              psr => psr.dc === dc\n            ) !== -1,\n          allChoice: dc === '*',\n        }))}\n      ></bldn-all-checklist>\n    `;\n  }\n\n  getOptionsTemplate(): TemplateResult<1 | 2> {\n    return html`\n      <bldn-dropdown>\n        <span slot=\"heading\"><strong>${msg('Date Restriction')}</strong></span>\n        <bldn-date-restriction\n          start=${ifDefined(this.demands[0].restrictions?.date_range?.from)}\n          end=${ifDefined(this.demands[0].restrictions?.date_range?.to)}\n        ></bldn-date-restriction>\n      </bldn-dropdown>\n      <bldn-dropdown>\n        <span slot=\"heading\"\n          ><strong>${msg('Provenance Restriction')}</strong></span\n        >\n        <bldn-provenance-restriction\n          term=${ifDefined(this.demands[0].restrictions?.provenance?.term)}\n        ></bldn-provenance-restriction>\n      </bldn-dropdown>\n      <bldn-dropdown>\n        <span slot=\"heading\"\n          ><strong>${msg('Additional Message')}</strong></span\n        >\n        <bldn-additional-message\n          message=${ifDefined(this.demands[0].message)}\n        ></bldn-additional-message>\n      </bldn-dropdown>\n    `;\n  }\n\n  getDefaultDemands(): PrivacyRequestDemand[] {\n    return [\n      {\n        id: '',\n        action: PrivacyRequestDemand.action.DELETE,\n        restrictions: {\n          privacy_scope: [\n            {\n              dc: '*',\n              pc: PrivacyScopeRestriction.pc._,\n              pp: PrivacyScopeRestriction.pp._,\n            },\n          ],\n          provenance: {\n            term: ProvenanceRestriction.term._,\n          },\n          date_range: {},\n        },\n      },\n    ];\n  }\n\n  // Listener Functions\n\n  /**\n   * Add a privacy scope restriction to this demand for the selected data category\n   * @param e {CustomEvent} Event containing the data category string to add\n   */\n  addDataCategory(e: Event) {\n    e.stopPropagation();\n    const { value } = (e as CustomEvent).detail;\n    this.demands[0].restrictions!.privacy_scope!.push({\n      dc: value,\n      pc: PrivacyScopeRestriction.pc._,\n      pp: PrivacyScopeRestriction.pp._,\n    });\n  }\n\n  /**\n   * Remove a privacy scope restriction to this demand for the deselected data category\n   * @param e {CustomEvent} Event containing the data category string to remove\n   */\n  removeDataCategory(e: Event) {\n    e.stopPropagation();\n    const { value } = (e as CustomEvent).detail;\n    this.demands[0].restrictions!.privacy_scope!.splice(\n      this.demands[0].restrictions!.privacy_scope!.findIndex(\n        psr => psr.dc === value\n      ),\n      1\n    );\n  }\n\n  /**\n   * Update the date restriction start for this demand\n   * @param e {CustomEvent} Event containing the new start date\n   */\n  changeDateRestrictionStart(e: Event) {\n    e.stopPropagation();\n    const { date } = (e as CustomEvent).detail;\n    this.demands[0].restrictions!.date_range!.from = date;\n  }\n\n  /**\n   * Update the date restriction end for this demand\n   * @param e {CustomEvent} Event containing the new end date\n   */\n  changeDateRestrictionEnd(e: Event) {\n    e.stopPropagation();\n    const { date } = (e as CustomEvent).detail;\n    this.demands[0].restrictions!.date_range!.to = date;\n  }\n\n  /**\n   * Update the provenance restriction term for this demand\n   * @param e {CustomEvent} Event containing the new provenance restriction term\n   */\n  changeProvenanceRestrictionTerm(e: Event) {\n    e.stopPropagation();\n    const { term } = (e as CustomEvent).detail;\n    this.demands[0].restrictions!.provenance!.term = term;\n  }\n\n  /**\n   * Update the message for this demand\n   * @param e {CustomEvent} Event containing the data category string to add\n   */\n  changeMessage(e: Event) {\n    e.stopPropagation();\n    const { message } = (e as CustomEvent).detail;\n    this.demands[0].message = message;\n  }\n\n  /**\n   * Add listeners for elements of this ActionForm\n   */\n  connectedCallback(): void {\n    // eslint-disable-next-line wc/guard-super-call\n    super.connectedCallback();\n\n    // Data category listeners\n    this.addEventListener(\n      'bldn-all-checklist:choice-select',\n      this.addDataCategory\n    );\n    this.addEventListener(\n      'bldn-all-checklist:choice-deselect',\n      this.removeDataCategory\n    );\n\n    // Date restriction listeners\n    this.addEventListener(\n      'bldn-date-restriction:start-date-change',\n      this.changeDateRestrictionStart\n    );\n    this.addEventListener(\n      'bldn-date-restriction:end-date-change',\n      this.changeDateRestrictionEnd\n    );\n\n    // Provenance restriction listener\n    this.addEventListener(\n      'bldn-provenance-restriction:term-change',\n      this.changeProvenanceRestrictionTerm\n    );\n\n    // Message listener\n    this.addEventListener(\n      'bldn-additional-message:message-change',\n      this.changeMessage\n    );\n  }\n\n  /**\n   * Remove all listeners\n   */\n  disconnectedCallback(): void {\n    this.removeEventListener(\n      'bldn-all-checklist:choice-select',\n      this.addDataCategory\n    );\n    this.removeEventListener(\n      'bldn-all-checklist:choice-deselect',\n      this.removeDataCategory\n    );\n    this.removeEventListener(\n      'bldn-date-restriction:start-date-change',\n      this.changeDateRestrictionStart\n    );\n    this.removeEventListener(\n      'bldn-date-restriction:end-date-change',\n      this.changeDateRestrictionEnd\n    );\n    this.removeEventListener(\n      'bldn-provenance-restriction:term-change',\n      this.changeProvenanceRestrictionTerm\n    );\n    this.removeEventListener(\n      'bldn-additional-message:message-change',\n      this.changeMessage\n    );\n  }\n\n  static styles = [\n    ActionForm.styles,\n    css`\n      :host {\n        text-align: left;\n        color: var(--bldn-delete-form-font-color, var(--color-dark));\n      }\n\n      p {\n        margin: 2em 0em;\n      }\n\n      p + bldn-all-checklist {\n        margin-top: 1em;\n        padding-left: 1em;\n      }\n    `,\n  ];\n}\n"],"names":[],"mappings":"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"}