{"version":3,"file":"BlindnetCore.js","sources":["../src/BlindnetCore.ts"],"sourcesContent":["import { ComputationAPI } from './computation/computation-api.js';\n\nexport interface CoreConfiguration {\n  /**\n   * base URL of the computation API\n   * if \"false\", then a mocked endpoint will be used\n   * if empty, then the blindnet staging endpoint will be used\n   *\n   * @example 'https://localhost:9000/v0\n   */\n  computationBaseUrl?: string;\n\n  /**\n   * Auth token or user ID to use in the authorization header of API requests.\n   * if empty, a default value 'john.doe@example.com' will be used.\n   */\n  apiToken?: string;\n\n  adminToken?: string;\n}\n\n/**\n * Central utilitary class for the @blindnet/core library.\n */\nexport abstract class BlindnetCore {\n  private static _configuration: CoreConfiguration;\n\n  /**\n   * Set-up the global configuration for all privacy components in the document.\n   *\n   * @param force override any preexisting configuration\n   * @returns true if the new configuration has been taken into account\n   */\n  static configure(configuration: CoreConfiguration, force = true): boolean {\n    const isConfigUpdated = BlindnetCore.setUp(configuration, force);\n    if (isConfigUpdated) {\n      BlindnetCore._configuration = configuration;\n    }\n    return isConfigUpdated;\n  }\n\n  static setToken(apiToken: string) {\n    BlindnetCore._configuration.apiToken = apiToken;\n    ComputationAPI.getInstance().setToken(apiToken);\n  }\n\n  static setAdminToken(adminToken: string) {\n    BlindnetCore._configuration.adminToken = adminToken;\n    ComputationAPI.getInstance().setAdminToken(adminToken);\n  }\n\n  /**\n   * Use configuration to correctly set up everything internally.\n   *\n   * @param force override any preexisting configuration\n   */\n  private static setUp(\n    configuration: CoreConfiguration,\n    force: boolean\n  ): boolean {\n    let isConfigUpdated = true;\n    isConfigUpdated =\n      isConfigUpdated &&\n      ComputationAPI.configure(\n        configuration.computationBaseUrl,\n        configuration.apiToken,\n        configuration.adminToken,\n        force\n      );\n    return isConfigUpdated;\n  }\n\n  /**\n   * Get the configuration currently applied to all privacy components in the document.\n   */\n  static get configuration() {\n    return BlindnetCore._configuration;\n  }\n}\n\ndeclare global {\n  // eslint-disable-next-line no-var, vars-on-top\n  var BlindnetCore: BlindnetCore;\n}\n\n// for debugging and more advanced usage\n// eslint-disable-next-line no-undef\n(globalThis || window).BlindnetCore = BlindnetCore;\n"],"names":[],"mappings":";;AAqBA;;AAEG;MACmB,YAAY,CAAA;AAGhC;;;;;AAKG;AACH,IAAA,OAAO,SAAS,CAAC,aAAgC,EAAE,KAAK,GAAG,IAAI,EAAA;QAC7D,MAAM,eAAe,GAAG,YAAY,CAAC,KAAK,CAAC,aAAa,EAAE,KAAK,CAAC,CAAC;AACjE,QAAA,IAAI,eAAe,EAAE;AACnB,YAAA,YAAY,CAAC,cAAc,GAAG,aAAa,CAAC;AAC7C,SAAA;AACD,QAAA,OAAO,eAAe,CAAC;KACxB;IAED,OAAO,QAAQ,CAAC,QAAgB,EAAA;AAC9B,QAAA,YAAY,CAAC,cAAc,CAAC,QAAQ,GAAG,QAAQ,CAAC;QAChD,cAAc,CAAC,WAAW,EAAE,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC;KACjD;IAED,OAAO,aAAa,CAAC,UAAkB,EAAA;AACrC,QAAA,YAAY,CAAC,cAAc,CAAC,UAAU,GAAG,UAAU,CAAC;QACpD,cAAc,CAAC,WAAW,EAAE,CAAC,aAAa,CAAC,UAAU,CAAC,CAAC;KACxD;AAED;;;;AAIG;AACK,IAAA,OAAO,KAAK,CAClB,aAAgC,EAChC,KAAc,EAAA;QAEd,IAAI,eAAe,GAAG,IAAI,CAAC;QAC3B,eAAe;YACb,eAAe;AACf,gBAAA,cAAc,CAAC,SAAS,CACtB,aAAa,CAAC,kBAAkB,EAChC,aAAa,CAAC,QAAQ,EACtB,aAAa,CAAC,UAAU,EACxB,KAAK,CACN,CAAC;AACJ,QAAA,OAAO,eAAe,CAAC;KACxB;AAED;;AAEG;AACH,IAAA,WAAW,aAAa,GAAA;QACtB,OAAO,YAAY,CAAC,cAAc,CAAC;KACpC;AACF,CAAA;AAOD;AACA;AACA,CAAC,UAAU,IAAI,MAAM,EAAE,YAAY,GAAG,YAAY;;;;"}