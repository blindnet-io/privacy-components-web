import{s as e,i as t,y as n}from"./6057ea6f.js";import{n as o}from"./44912706.js";import{l as r}from"./90c30cd8.js";import{A as i}from"./3f448e88.js";import"./f9de6251.js";function a(e){this.message=e}a.prototype=new Error,a.prototype.name="InvalidCharacterError";var s="undefined"!=typeof window&&window.atob&&window.atob.bind(window)||function(e){var t=String(e).replace(/=+$/,"");if(t.length%4==1)throw new a("'atob' failed: The string to be decoded is not correctly encoded.");for(var n,o,r=0,i=0,s="";o=t.charAt(i++);~o&&(n=r%4?64*n+o:o,r++%4)?s+=String.fromCharCode(255&n>>(-2*r&6)):0)o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(o);return s};function d(e){var t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw"Illegal base64url string!"}try{return function(e){return decodeURIComponent(s(e).replace(/(.)/g,(function(e,t){var n=t.charCodeAt(0).toString(16).toUpperCase();return n.length<2&&(n="0"+n),"%"+n})))}(t)}catch(e){return s(t)}}function c(e){this.message=e}c.prototype=new Error,c.prototype.name="InvalidTokenError";const l=new i({domain:"blindnet.eu.auth0.com",client_id:"1C0uhFCpzvJAkFi4uqoq2oAWSgQicqHc",audience:"https://blindnet-connector-demo-staging.azurewebsites.net",redirect_uri:`${window.location.origin}/demos/devkit-simple-tutorial/privacy`,authorizationParams:{redirect_uri:`${window.location.origin}/demos/devkit-simple-tutorial/privacy`},languageDictionary:{title:"Let us verify your e-mail",passwordlessEmailInstructions:"Enter the email associated<br/>with your data",signUpTerms:"By clicking SUMBIT, you give consent for processing your data (email) for the purposes of identifying you and processing your privacy request.",success:{logIn:"Email verified.",magicLink:"We sent you a link to verify<br />your e-mail at %s."}},allowSignUp:!1,passwordlessMethod:"link"});class u extends e{static get properties(){return{_apiToken:{state:!0},_intervalId:{state:!0}}}static get styles(){return t`:host{display:block;width:40vw;max-width:950px;padding:50px 100px;background:#fff;box-shadow:0 4px 12px rgba(0,0,0,.34),0 .500862px 1.50259px rgba(0,0,0,.17);border-radius:20px}bldn-priv-request{margin-bottom:65px}`}async getBlindnetToken(e){return fetch("https://blindnet-connector-demo-staging.azurewebsites.net/auth/token",{method:"GET",headers:{Authorization:`Bearer ${e}`}})}handleLoginClick(){window.location.href=`${window.location.origin}/demos/devkit-simple-tutorial/login`}handleLogoutClick(){l.logout()}connectedCallback(){super.connectedCallback(),this._intervalId=setInterval((()=>{const e=this.renderRoot.querySelector("bldn-priv-request")?.shadowRoot?.querySelector("bldn-submitted-requests")?.shadowRoot?.querySelector("bldn-request-status")?.shadowRoot?.querySelector("bldn-dropdown.main-section")?.querySelector("#summary-heading")?.querySelector("#refresh-request");e?.dispatchEvent(new Event("bldn-button:click"))}),3e3)}disconnectedCallback(){super.disconnectedCallback(),clearInterval(this._intervalId)}render(){return void 0===this._apiToken&&l.getTokenSilently().then((e=>{this.getBlindnetToken(e).then((e=>{e.json().then((e=>{this._apiToken=e}))})).catch((e=>{console.log(e)}))})).catch((()=>{})),n` <bldn-priv-request data-categories='["contact", "name", "uid", "other-data"]' api-token="${r(this._apiToken)}"></bldn-priv-request> ${o(this._apiToken,(()=>n` <span>Making a Privacy Request as ${function(e,t){if("string"!=typeof e)throw new c("Invalid token specified");var n=!0===(t=t||{}).header?0:1;try{return JSON.parse(d(e.split(".")[n]))}catch(e){throw new c("Invalid token specified: "+e.message)}}(this._apiToken).uid}.</span> <bldn-button @click="${this.handleLogoutClick}" mode="link"> Change </bldn-button> `),(()=>n` <bldn-button @click="${this.handleLoginClick}" mode="link"> Verify your e-mail </bldn-button> `))} `}}customElements.define("app-privacy",u);export{u as AppPrivacy};
